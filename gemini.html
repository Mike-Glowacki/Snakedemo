<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fixed Drum & Snake Machine</title>
    <style>
        body { 
            background: #121212; color: white; font-family: sans-serif; 
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }
        canvas { background: #000; border: 3px solid #333; margin: 20px; touch-action: none; }
        .controls { background: #222; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
        button { padding: 10px 20px; cursor: pointer; background: #4CAF50; border: none; color: white; font-weight: bold; }
        .grid { display: grid; grid-template-columns: repeat(9, 40px); gap: 5px; margin-top: 10px; }
        .pad { width: 40px; height: 40px; background: #333; border-radius: 4px; cursor: pointer; }
        .pad.active { background: #4CAF50; }
        .pad.playing { border: 2px solid white; }
    </style>
</head>
<body>

    <h2>1. The Drum Machine (Synth Edition)</h2>
    <div class="controls">
        <button id="playDrum">Start/Stop Drum Loop</button>
        <div class="grid" id="drumGrid"></div>
    </div>

    <h2>2. The Snake Game</h2>
    <p>Click the game area, then use Arrow Keys</p>
    <canvas id="snakeGame" width="300" height="300"></canvas>

    <script>
        // --- AUDIO SYNTH LOGIC (No external files needed!) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSynth(freq, type, duration) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        // --- DRUM MACHINE LOGIC ---
        const grid = document.getElementById('drumGrid');
        const playBtn = document.getElementById('playDrum');
        let drumTick = 0;
        let drumInterval;

        for (let i = 0; i < 3; i++) { // 3 sounds
            for (let j = 0; j < 8; j++) { // 8 steps
                const p = document.createElement('div');
                p.className = 'pad';
                p.dataset.row = i;
                p.dataset.step = j;
                p.onclick = () => p.classList.toggle('active');
                grid.appendChild(p);
            }
            grid.appendChild(document.createElement('br'));
        }

        playBtn.onclick = () => {
            if (drumInterval) {
                clearInterval(drumInterval);
                drumInterval = null;
            } else {
                drumInterval = setInterval(() => {
                    const pads = document.querySelectorAll('.pad');
                    pads.forEach(p => p.classList.remove('playing'));
                    
                    for (let r = 0; r < 3; r++) {
                        const activePad = document.querySelector(`.pad[data-row="${r}"][data-step="${drumTick}"]`);
                        activePad.classList.add('playing');
                        if (activePad.classList.contains('active')) {
                            if (r === 0) playSynth(150, 'sine', 0.2); // Kick
                            if (r === 1) playSynth(400, 'square', 0.1); // Snare
                            if (r === 2) playSynth(1000, 'triangle', 0.05); // Hat
                        }
                    }
                    drumTick = (drumTick + 1) % 8;
                }, 200);
            }
        };

        // --- SNAKE LOGIC ---
        const canvas = document.getElementById('snakeGame');
        const ctx = canvas.getContext('2d');
        let snake = [{x: 10, y: 10}];
        let food = {x: 5, y: 5};
        let dx = 0, dy = 0;

        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowUp' && dy === 0) { dx = 0; dy = -1; }
            if (e.key === 'ArrowDown' && dy === 0) { dx = 0; dy = 1; }
            if (e.key === 'ArrowLeft' && dx === 0) { dx = -1; dy = 0; }
            if (e.key === 'ArrowRight' && dx === 0) { dx = 1; dy = 0; }
        });

        function gameLoop() {
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            
            // Wall wrap-around
            if (head.x < 0) head.x = 14; if (head.x > 14) head.x = 0;
            if (head.y < 0) head.y = 14; if (head.y > 14) head.y = 0;

            snake.unshift(head);
            if (head.x === food.x && head.y === food.y) {
                food = { x: Math.floor(Math.random()*15), y: Math.floor(Math.random()*15) };
                playSynth(600, 'sine', 0.1); // Eat sound
            } else {
                snake.pop();
            }

            ctx.fillStyle = 'black'; ctx.fillRect(0,0,300,300);
            ctx.fillStyle = 'red'; ctx.fillRect(food.x*20, food.y*20, 18, 18);
            ctx.fillStyle = 'lime';
            snake.forEach(p => ctx.fillRect(p.x*20, p.y*20, 18, 18));
            
            setTimeout(gameLoop, 150);
        }
        gameLoop();
    </script>
</body>
</html>
